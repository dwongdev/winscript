document.addEventListener("DOMContentLoaded", function () {
  const parentDiv = document.querySelector(".allScripts");

  function addScript(className, scriptContent) {
    const newDiv = document.createElement("div");
    const codeElement = document.createElement("code");

    newDiv.className = className;
    codeElement.className = "language-powershell";
    codeElement.textContent = scriptContent;

    newDiv.appendChild(codeElement);
    parentDiv.appendChild(newDiv);
    hljs.highlightElement(codeElement);
  }

  function removeScripts(className) {
    parentDiv.querySelectorAll(`.${className}`).forEach((el) => el.remove());
  }

  const scripts = {
    microsoftstore: [
      "Write-Host '-- Uninstalling Microsoft Store' -ForegroundColor Green",
      'Get-AppxPackage "*Microsoft.WindowsStore*" | Remove-AppxPackage',
    ],
    msstoreupdates: [
      "Write-Host '-- Disabling Microsoft Store App Updates' -ForegroundColor Green",
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\WindowsStore" /v "AutoDownload" /t REG_DWORD /d 2 /f',
    ],
    onedrive: [
      'Write-Host "-- Uninstalling OneDrive" -ForegroundColor Green',
      'Stop-Process -Name "OneDrive" -Force',
      '$onedriveUninstaller = "$env:SystemRoot\\System32\\OneDriveSetup.exe"',
      "if (Test-Path $onedriveUninstaller) {",
      '    Write-Host "-- Uninstalling OneDrive through the installers"',
      '    Start-Process -FilePath $onedriveUninstaller -ArgumentList "/uninstall" -Wait',
      "}",
      'Write-Host "-- Copying OneDrive files to local folders"',
      'robocopy "$env:USERPROFILE\\OneDrive" "$env:USERPROFILE" /mov /e /xj /ndl /nfl /njh /njs /nc /ns /np | Out-Null',
      'Write-Host "-- Removing OneDrive from explorer sidebar"',
      'Remove-Item -Path "HKCR:\\WOW6432Node\\CLSID\\{018D5C66-4533-4307-9B53-224DE2ED1FE6}" -Recurse -Force',
      'Remove-Item -Path "HKCR:\\CLSID\\{018D5C66-4533-4307-9B53-224DE2ED1FE6}" -Recurse -Force',
      'Write-Host "-- Removing shortcut entry"',
      'Remove-Item "$env:APPDATA\\Microsoft\\Windows\\Start Menu\\Programs\\OneDrive.lnk" -Force',
      'Write-Host "-- Removing scheduled task"',
      `Get-ScheduledTask -TaskPath '\\' -TaskName 'OneDrive*' -ErrorAction SilentlyContinue  | Unregister-ScheduledTask -Confirm:$false -ErrorAction SilentlyContinue`,
      'Write-Host "-- Removing OneDrive leftovers"',
      'Remove-Item -Path "$env:USERPROFILE\\OneDrive" -Recurse -Force',
      'Remove-Item -Path "$env:LOCALAPPDATA\\OneDrive" -Recurse -Force',
      'Remove-Item -Path "$env:LOCALAPPDATA\\Microsoft\\OneDrive" -Recurse -Force',
      'Remove-Item -Path "$env:ProgramData\\Microsoft OneDrive" -Recurse -Force',
      'Remove-Item -Path "C:\\OneDriveTemp" -Recurse -Force',
      'Remove-Item -Path "HKCU:\\Software\\Microsoft\\OneDrive" -Recurse -Force',
    ],
    debloatedge: [
      "Write-Host '-- Debloating Edge' -ForegroundColor Green",
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Edge" /v "EdgeEnhanceImagesEnabled" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Edge" /v "PersonalizationReportingEnabled" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Edge" /v "ShowRecommendationsEnabled" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Edge" /v "HideFirstRunExperience" /t REG_DWORD /d 1 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Edge" /v "UserFeedbackAllowed" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Edge" /v "ConfigureDoNotTrack" /t REG_DWORD /d 1 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Edge" /v "AlternateErrorPagesEnabled" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Edge" /v "EdgeCollectionsEnabled" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Edge" /v "EdgeFollowEnabled" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Edge" /v "EdgeShoppingAssistantEnabled" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Edge" /v "MicrosoftEdgeInsiderPromotionEnabled" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Edge" /v "RelatedMatchesCloudServiceEnabled" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Edge" /v "ShowMicrosoftRewards" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Edge" /v "WebWidgetAllowed" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Edge" /v "MetricsReportingEnabled" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Edge" /v "StartupBoostEnabled" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Edge" /v "BingAdsSuppression" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Edge" /v "NewTabPageHideDefaultTopSites" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Edge" /v "PromotionalTabsEnabled" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Edge" /v "SendSiteInfoToImproveServices" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Edge" /v "SpotlightExperiencesAndRecommendationsEnabled" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Edge" /v "DiagnosticData" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Edge" /v "EdgeAssetDeliveryServiceEnabled" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Edge" /v "CryptoWalletEnabled" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Edge" /v "WalletDonationEnabled" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Edge" /v "HubsSidebarEnabled" /t "REG_DWORD" /d "0" /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Edge" /v "CopilotPageAction" /t "REG_DWORD" /d "0" /f',
    ],
    edge: [
      "Write-Host '-- Uninstalling Edge' -ForegroundColor Green",
      '$Path = (Get-ChildItem "C:\\Program Files (x86)\\Microsoft\\Edge\\Application\\*\\Installer\\setup.exe")[0].FullName',
      'New-Item "C:\\Windows\\SystemApps\\Microsoft.MicrosoftEdge_8wekyb3d8bbwe\\MicrosoftEdge.exe" -Force',
      "Start-Process $Path -ArgumentList '--uninstall --system-level --force-uninstall --delete-profile'",
    ],
    copilot: [
      "Write-Host '-- Removing Copilot' -ForegroundColor Green",
      'Get-AppxPackage "Microsoft.CoPilot" | Remove-AppxPackage',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsCopilot" /v "TurnOffWindowsCopilot" /t "REG_DWORD" /d "1" /f',
      'reg add "HKCU\\Software\\Policies\\Microsoft\\Windows\\WindowsCopilot" /v "TurnOffWindowsCopilot" /t "REG_DWORD" /d "1" /f',
      'reg add "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Notifications\\Settings" /v "AutoOpenCopilotLargeScreens" /t "REG_DWORD" /d "0" /f',
      'reg add "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced" /v "ShowCopilotButton" /t "REG_DWORD" /d "0" /f',
      'reg add "HKLM\\SOFTWARE\\Microsoft\\Windows\\Shell\\Copilot" /v "CopilotDisabledReason" /t "REG_SZ" /d "IsEnabledForGeographicRegionFailed" /f',
      'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\WindowsCopilot" /v "AllowCopilotRuntime" /t "REG_DWORD" /d "0" /f',
      'reg add "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Shell Extensions\\Blocked" /v "{CB3B0003-8088-4EDE-8769-8B354AB2FF8C}" /t "REG_SZ" /d "" /f',
      'reg add "HKLM\\SOFTWARE\\Microsoft\\Windows\\Shell\\Copilot" /v "IsCopilotAvailable" /t "REG_DWORD" /d "0" /f',
      'reg add "HKCU\\Software\\Microsoft\\Windows\\Shell\\Copilot\\BingChat" /v "IsUserEligible" /t "REG_DWORD" /d "0" /f',
    ],
    widgets: [
      "Write-Host '-- Uninstalling Widgets' -ForegroundColor Green",
      "Get-AppxPackage *WebExperience* | Remove-AppxPackage",
      'reg add "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Appx\\AppxAllUserStore\\Deprovisioned\\MicrosoftWindows.Client.WebExperience_cw5n1h2txyewy" /f',
    ],
    thirdparty: [
      "Write-Host '-- Uninstalling third-party apps' -ForegroundColor Green",
      `@("ShazamEntertainmentLtd.Shazam","ClearChannelRadioDigital.iHeartRadio","SpotifyAB.SpotifyMusic","*EclipseManager*","*ActiproSoftwareLLC*","*AdobeSystemsIncorporated.AdobePhotoshopExpress*","*Duolingo-LearnLanguagesforFree*","*PandoraMediaInc*","*CandyCrush*","*BubbleWitch3Saga*","*Wunderlist*","*Flipboard*","*Twitter*","*Facebook*","*Royal Revolt*","*Sway*","*Speed Test*","*Dolby*","*Viber*","*ACGMediaPlayer*","*Netflix*","*OneCalendar*","*LinkedInForWindows*","*HiddenCityMysteryofShadows*","*Hulu*","*HiddenCity*","*AdobePhotoshopExpress*") | ForEach-Object { $pkg = Get-AppxPackage $_; if ($pkg) { $pkg | Remove-AppxPackage; Write-Host "Removed: $_" } }`,
    ],
    extensions: [
      "Write-Host '-- Uninstalling extensions' -ForegroundColor Green",
      `@("Microsoft.HEIFImageExtension","Microsoft.VP9VideoExtensions","Microsoft.WebpImageExtension","Microsoft.HEVCVideoExtension","Microsoft.RawImageExtension","Microsoft.WebMediaExtensions") | ForEach-Object { $pkg = Get-AppxPackage $_; if ($pkg) { $pkg | Remove-AppxPackage; Write-Host "Removed: $_" } }`,
    ],
    msapps: [
      "Write-Host '-- Uninstalling Microsoft apps' -ForegroundColor Green",
      `@("Microsoft.ZuneMusic","Microsoft.Whiteboard","Microsoft.Office.Lens","Microsoft.News","Microsoft.GetHelp","Microsoft.BingTravel","Microsoft.BingHealthAndFitness","Microsoft.BingFoodAndDrink","Microsoft.BingTranslator","Microsoft.AppConnector","MicrosoftCorporationII.MicrosoftFamily","*QuickAssist*","Microsoft.OutlookForWindows","Clipchamp.Clipchamp","Microsoft.3DBuilder","Microsoft.Microsoft3DViewer","Microsoft.BingWeather","Microsoft.BingSports","Microsoft.BingFinance","Microsoft.MicrosoftOfficeHub","Microsoft.BingNews","Microsoft.Office.OneNote","Microsoft.Office.Sway","Microsoft.WindowsPhone","Microsoft.CommsPhone","Microsoft.YourPhone","Microsoft.Getstarted","Microsoft.549981C3F5F10","Microsoft.Messaging","Microsoft.WindowsSoundRecorder","Microsoft.MixedReality.Portal","Microsoft.WindowsFeedbackHub","Microsoft.WindowsAlarms","Microsoft.MSPaint","Microsoft.WindowsMaps","Microsoft.MinecraftUWP","Microsoft.People","Microsoft.Wallet","Microsoft.Print3D","Microsoft.OneConnect","Microsoft.MicrosoftSolitaireCollection","Microsoft.MicrosoftStickyNotes","microsoft.windowscommunicationsapps","Microsoft.SkypeApp","Microsoft.GroupMe10","MSTeams","Microsoft.Todos") | ForEach-Object { $pkg = Get-AppxPackage $_; if ($pkg) { $pkg | Remove-AppxPackage; Write-Host "Removed: $_" } }`,
    ],
    xbox: [
      "Write-Host '-- Uninstalling Xbox' -ForegroundColor Green",
      `@("Microsoft.XboxApp","Microsoft.Xbox.TCUI","Microsoft.XboxGamingOverlay","Microsoft.XboxGameOverlay","Microsoft.XboxIdentityProvider","Microsoft.XboxSpeechToTextOverlay","Microsoft.GamingApp") | ForEach-Object { $pkg = Get-AppxPackage $_ -AllUsers; if ($pkg) { $pkg | Remove-AppxPackage -AllUsers; Write-Host "Removed: $_" } }`,
      'reg add "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Appx\\AppxAllUserStore\\Deprovisioned\\Microsoft.XboxSpeechToTextOverlay_8wekyb3d8bbwe" /f',
      'reg add "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Appx\\AppxAllUserStore\\Deprovisioned\\Microsoft.Xbox.TCUI_8wekyb3d8bbwe" /f',
      'reg add "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Appx\\AppxAllUserStore\\Deprovisioned\\Microsoft.XboxApp_8wekyb3d8bbwe" /f',
      'reg add "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Appx\\AppxAllUserStore\\Deprovisioned\\Microsoft.XboxGamingOverlay_8wekyb3d8bbwe" /f',
      'reg add "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Appx\\AppxAllUserStore\\Deprovisioned\\Microsoft.XboxGameOverlay_8wekyb3d8bbwe" /f',
      'Set-Service -Name "XblAuthManager" -StartupType Manual',
      'Set-Service -Name "XblGameSave" -StartupType Manual',
      'Set-Service -Name "XboxGipSvc" -StartupType Manual',
      'Set-Service -Name "XboxNetApiSvc" -StartupType Manual',
    ],
    consumerfeatures: [
      "Write-Host '-- Disabling Consumer Features' -ForegroundColor Green",
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\CloudContent" /v "DisableWindowsConsumerFeatures" /t "REG_DWORD" /d "1" /f',
    ],
    recall: [
      "Write-Host '-- Disabling Recall' -ForegroundColor Green",
      'DISM /Online /Disable-Feature /NoRestart /FeatureName:Recall | Out-Null; if ($LASTEXITCODE -eq 0) { Write-Host "Successfully removed the feature: Recall" } else { Write-Host "Feature not found: Recall" }',
      `$recallTasks = @('\\Microsoft\\Windows\\WindowsAI\\*', '\\Microsoft\\Windows\\Recall\\*'); foreach ($taskPath in $recallTasks) { try { $tasks = Get-ScheduledTask -TaskPath $taskPath -ErrorAction SilentlyContinue; if ($tasks) { $tasks | Unregister-ScheduledTask -Confirm:$false -ErrorAction Stop; $taskCount = ($tasks | Measure-Object).Count; Write-Host "Removed $taskCount task(s) from: $taskPath" -ForegroundColor Green; } } catch { Write-Host "Could not remove tasks from: $taskPath" -ForegroundColor Red; } }`,
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsAI" /v "DisableAIDataAnalysis" /t REG_DWORD /d 1 /f',
    ],
    notepadrewrite: [
      "Write-Host '-- Removing AI from Copilot' -ForegroundColor Green",
      'reg add "HKLM\\Software\\Policies\\WindowsNotepad" /v "DisableAIFeatures" /t REG_DWORD /d 1 /f',
      'reg add "HKCU\\Software\\Microsoft\\Notepad" /v "ShowRewriteButton" /t REG_DWORD /d 0 /f',
    ],
    aiappxpackages: [
      "Write-Host '-- Removing AI AppX Packages' -ForegroundColor Green",
      `$aiPackages = @('Microsoft.Windows.Ai.Copilot.Provider','Microsoft.Copilot','Microsoft.WindowsAiFoundation','Microsoft.Windows.Recall'); foreach ($package in $aiPackages) { try { $removed = $false; $appxPackages = Get-AppxPackage -Name $package -AllUsers; if ($appxPackages) { $appxPackages | Remove-AppxPackage -AllUsers; $removed = $true; } $provisionedPackages = Get-AppxProvisionedPackage -Online | Where-Object DisplayName -like $package; if ($provisionedPackages) { $provisionedPackages | Remove-AppxProvisionedPackage -Online; $removed = $true; } if ($removed) { Write-Host 'Removed: ' $package; } } catch { Write-Host 'Could not remove: ' $package -ForegroundColor Red; } }`,
    ],
    hideai: [
      "Write-Host '-- Hiding Copilot Button in Explorer' -ForegroundColor Green",
      'reg add "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced" /v "ShowCopilotButton" /t REG_DWORD /d 0 /f',
    ],
    aifiles: [
      "Write-Host '-- Removing AI Files' -ForegroundColor Green",
      `$aiPaths = @("$env:ProgramFiles\\WindowsApps\\Microsoft.Copilot*", "$env:ProgramFiles\\WindowsApps\\Microsoft.Windows.Ai*", "$env:LocalAppData\\Packages\\Microsoft.Copilot*", "$env:LocalAppData\\Packages\\Microsoft.Windows.Ai*", "$env:SystemRoot\\SystemApps\\Microsoft.Windows.Copilot*"); foreach ($path in $aiPaths) { if (Test-Path $path) { try { Remove-Item -Path $path -Recurse -Force; Write-Host "Removed: $path" -ForegroundColor Green } catch { Write-Host "Could not remove: $path" -ForegroundColor Red } } }`,
    ],
    iexplorer: [
      "Write-Host '-- Disabling Internet Explorer' -ForegroundColor Green",
      'dism /online /Disable-Feature /FeatureName:Internet-Explorer-Optional-amd64 | Out-Null; if ($LASTEXITCODE -eq 0) { Write-Host "Successfully removed the feature: Internet-Explorer-Optional-amd64" } else { Write-Host "Feature not found: Internet-Explorer-Optional-amd64" }',
    ],
    hyperv: [
      "Write-Host '-- Disabling Hyper-V' -ForegroundColor Green",
      'try { Disable-WindowsOptionalFeature -FeatureName "Microsoft-Hyper-V-All" -Online -NoRestart -ErrorAction Stop; Write-Output "Successfully disabled the feature Microsoft-Hyper-V-All." } catch { Write-Output "Feature not found: Microsoft-Hyper-V-All" }',
    ],
    faxscan: [
      "Write-Host '-- Disabling Fax and Scan' -ForegroundColor Green",
      'dism /Online /Disable-Feature /FeatureName:FaxServicesClientPackage | Out-Null; if ($LASTEXITCODE -eq 0) { Write-Host "Successfully removed the feature: FaxServicesClientPackage" } else { Write-Host "Feature not found: FaxServicesClientPackage" }',
    ],
    mediaplayer: [
      "Write-Host '-- Disabling Windows Media Player' -ForegroundColor Green",
      'try { Disable-WindowsOptionalFeature -FeatureName "WindowsMediaPlayer" -Online -NoRestart -ErrorAction Stop | Out-Null; Write-Output "-- Successfully disabled the feature WindowsMediaPlayer." } catch { Write-Output "Feature not found." }',
    ],
    wsearch: [
      "Write-Host '-- Disabling Windows Search' -ForegroundColor Green",
      'Stop-Service -Name "wsearch"',
      'Set-Service -Name "wsearch" -StartupType Disabled',
    ],
    wtelemetry: [
      "Write-Host '-- Disabling Windows Telemetry' -ForegroundColor Green",
      'Disable-ScheduledTask -TaskName "\\Microsoft\\Windows\\Customer Experience Improvement Program\\Consolidator" -ErrorAction SilentlyContinue',
      'Disable-ScheduledTask -TaskName "\\Microsoft\\Windows\\Customer Experience Improvement Program\\KernelCeipTask" -ErrorAction SilentlyContinue',
      'Disable-ScheduledTask -TaskName "\\Microsoft\\Windows\\Customer Experience Improvement Program\\UsbCeip" -ErrorAction SilentlyContinue',
      'Disable-ScheduledTask -TaskName "\\Microsoft\\Windows\\Autochk\\Proxy" -ErrorAction SilentlyContinue',
      'Disable-ScheduledTask -TaskName "\\Microsoft\\Windows\\DiskDiagnostic\\Microsoft-Windows-DiskDiagnosticDataCollector" -ErrorAction SilentlyContinue',
      'Disable-ScheduledTask -TaskName "\\Microsoft\\Windows\\Feedback\\Siuf\\DmClient" -ErrorAction SilentlyContinue',
      'Disable-ScheduledTask -TaskName "\\Microsoft\\Windows\\Feedback\\Siuf\\DmClientOnScenarioDownload" -ErrorAction SilentlyContinue',
      'Disable-ScheduledTask -TaskName "\\Microsoft\\Windows\\Windows Error Reporting\\QueueReporting" -ErrorAction SilentlyContinue',
      'Disable-ScheduledTask -TaskName "\\Microsoft\\Windows\\Maps\\MapsUpdateTask" -ErrorAction SilentlyContinue',
      'Set-Service -Name "diagsvc" -StartupType Manual',
      'Set-Service -Name "WerSvc" -StartupType Manual',
      'Set-Service -Name "wercplsupport" -StartupType Manual',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\DataCollection" /v "AllowDesktopAnalyticsProcessing" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\DataCollection" /v "AllowDeviceNameInTelemetry" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\DataCollection" /v "MicrosoftEdgeDataOptIn" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\DataCollection" /v "AllowWUfBCloudProcessing" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\DataCollection" /v "AllowUpdateComplianceProcessing" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\DataCollection" /v "AllowCommercialDataPipeline" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\Software\\Policies\\Microsoft\\SQMClient\\Windows" /v "CEIPEnable" /t REG_DWORD /d "0" /f',
      'reg add "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\DataCollection" /v "AllowTelemetry" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\DataCollection" /v "AllowTelemetry" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\Software\\Policies\\Microsoft\\Windows\\DataCollection" /v "DisableOneSettingsDownloads" /t "REG_DWORD" /d "1" /f',
      'reg add "HKLM\\Software\\Policies\\Microsoft\\Windows NT\\CurrentVersion\\Software Protection Platform" /v "NoGenTicket" /t "REG_DWORD" /d "1" /f',
      'reg add "HKLM\\Software\\Policies\\Microsoft\\Windows\\Windows Error Reporting" /v "Disabled" /t REG_DWORD /d "1" /f',
      'reg add "HKLM\\SOFTWARE\\Microsoft\\Windows\\Windows Error Reporting" /v "Disabled" /t "REG_DWORD" /d "1" /f',
      'reg add "HKLM\\Software\\Microsoft\\Windows\\Windows Error Reporting\\Consent" /v "DefaultConsent" /t REG_DWORD /d "0" /f',
      'reg add "HKLM\\Software\\Microsoft\\Windows\\Windows Error Reporting\\Consent" /v "DefaultOverrideBehavior" /t REG_DWORD /d "1" /f',
      'reg add "HKLM\\Software\\Microsoft\\Windows\\Windows Error Reporting" /v "DontSendAdditionalData" /t REG_DWORD /d "1" /f',
      'reg add "HKLM\\Software\\Microsoft\\Windows\\Windows Error Reporting" /v "LoggingDisabled" /t REG_DWORD /d "1" /f',
      'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\ContentDeliveryManager" /v "ContentDeliveryAllowed" /d "0" /t REG_DWORD /f',
      'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\ContentDeliveryManager" /v "OemPreInstalledAppsEnabled" /d "0" /t REG_DWORD /f',
      'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\ContentDeliveryManager" /v "PreInstalledAppsEnabled" /d "0" /t REG_DWORD /f',
      'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\ContentDeliveryManager" /v "PreInstalledAppsEverEnabled" /d "0" /t REG_DWORD /f',
      'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\ContentDeliveryManager" /v "SilentInstalledAppsEnabled" /d "0" /t REG_DWORD /f',
      'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\ContentDeliveryManager" /v "SystemPaneSuggestionsEnabled" /d "0" /t REG_DWORD /f',
      'reg add "HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\SystemSettings\\AccountNotifications" /v "EnableAccountNotifications" /t REG_DWORD /d "0" /f',
      'reg add "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\SystemSettings\\AccountNotifications" /v "EnableAccountNotifications" /t REG_DWORD /d "0" /f',
      'reg add "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Notifications\\Settings" /v "NOC_GLOBAL_SETTING_TOASTS_ENABLED" /t REG_DWORD /d "0" /f',
      'reg add "HKCU\\Software\\Policies\\Microsoft\\Windows\\EdgeUI" /v "DisableMFUTracking" /t REG_DWORD /d "1" /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\EdgeUI" /v "DisableMFUTracking" /t REG_DWORD /d "1" /f',
      'reg add "HKCU\\Control Panel\\International\\User Profile" /v "HttpAcceptLanguageOptOut" /t REG_DWORD /d "1" /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\System" /v "PublishUserActivities" /t REG_DWORD /d "0" /f',
    ],
    wupdate: [
      "Write-Host '-- Disabling Windows Update Telemetry' -ForegroundColor Green",
      'reg add "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\DriverSearching" /v "SearchOrderConfig" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\DeliveryOptimization" /v "DODownloadMode" /t "REG_DWORD" /d 0 /f',
    ],
    wsearchtelemetry: [
      "Write-Host '-- Disabling Windows Search Telemetry' -ForegroundColor Green",
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search" /v "ConnectedSearchPrivacy" /t REG_DWORD /d "3" /f',
      'reg add "HKLM\\Software\\Policies\\Microsoft\\Windows\\Explorer" /v "DisableSearchHistory" /t REG_DWORD /d "1" /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search" /v "AllowSearchToUseLocation" /t "REG_DWORD" /d "0" /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search" /v "EnableDynamicContentInWSB" /t "REG_DWORD" /d "0" /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search" /v "ConnectedSearchUseWeb" /t "REG_DWORD" /d "0" /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search" /v "DisableWebSearch" /t "REG_DWORD" /d "1" /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Explorer" /v "DisableSearchBoxSuggestions" /t "REG_DWORD" /d "1" /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search" /v "PreventUnwantedAddIns" /t "REG_SZ" /d " " /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search" /v "PreventRemoteQueries" /t REG_DWORD /d "1" /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search" /v "AlwaysUseAutoLangDetection" /t "REG_DWORD" /d "0" /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search" /v "AllowIndexingEncryptedStoresOrItems" /t "REG_DWORD" /d "0" /f',
      'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Search" /v "DisableSearchBoxSuggestions" /t "REG_DWORD" /d "1" /f',
      'reg add "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Search" /v "CortanaInAmbientMode" /t "REG_DWORD" /d "0" /f',
      'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Search" /v "BingSearchEnabled" /t "REG_DWORD" /d "0" /f',
      'reg add "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced" /v "ShowCortanaButton" /t "REG_DWORD" /d "0" /f',
      'reg add "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Search" /v "CanCortanaBeEnabled" /t "REG_DWORD" /d "0" /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search" /v "ConnectedSearchUseWebOverMeteredConnections" /t "REG_DWORD" /d "0" /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search" /v "AllowCortanaAboveLock" /t "REG_DWORD" /d "0" /f',
      'reg add "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\SearchSettings" /v "IsDynamicSearchBoxEnabled" /t "REG_DWORD" /d "1" /f',
      'reg add "HKLM\\SOFTWARE\\Microsoft\\PolicyManager\\default\\Experience\\AllowCortana" /v "value" /t REG_DWORD /d 0 /f',
      'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Search" /v "AllowSearchToUseLocation" /t "REG_DWORD" /d "1" /f',
      'reg add "HKCU\\Software\\Microsoft\\Speech_OneCore\\Preferences" /v "ModelDownloadAllowed" /t "REG_DWORD" /d "0" /f',
      'reg add "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\SearchSettings" /v "IsDeviceSearchHistoryEnabled" /t REG_DWORD /d "1" /f',
      'reg add "HKCU\\Software\\Microsoft\\Speech_OneCore\\Preferences" /v "VoiceActivationOn" /t REG_DWORD /d 0 /f',
      'reg add "HKCU\\Software\\Microsoft\\Speech_OneCore\\Preferences" /v "VoiceActivationEnableAboveLockscreen" /t "REG_DWORD" /d "0" /f',
      'reg add "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\OOBE" /v "DisableVoice" /t "REG_DWORD" /d "1" /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search" /v "AllowCortana" /t "REG_DWORD" /d "0" /f',
      'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Search" /v "DeviceHistoryEnabled" /t REG_DWORD /d 0 /f',
      'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Search" /v "HistoryViewEnabled" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\Software\\Microsoft\\Speech_OneCore\\Preferences" /v "VoiceActivationDefaultOn" /t REG_DWORD /d 0 /f',
      'reg add "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Search" /v "CortanaEnabled" /t "REG_DWORD" /d "0" /f',
      'reg add "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Search" /v "CortanaEnabled" /t "REG_DWORD" /d "0" /f',
      'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\SearchSettings" /v "IsMSACloudSearchEnabled" /t REG_DWORD /d "0" /f',
      'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\SearchSettings" /v "IsAADCloudSearchEnabled" /t REG_DWORD /d "0" /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Search" /v "AllowCloudSearch" /t "REG_DWORD" /d "0" /f',
      'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Search" /v "VoiceShortcut" /t "REG_DWORD" /d "0" /f',
      'reg add "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Search" /v "CortanaConsent" /t "REG_DWORD" /d "0" /f',
    ],
    officetelemetry: [
      "Write-Host '-- Disabling Office telemetry' -ForegroundColor Green",
      'reg add "HKCU\\SOFTWARE\\Microsoft\\Office\\15.0\\Outlook\\Options\\Mail" /v "EnableLogging" /t REG_DWORD /d 0 /f',
      'reg add "HKCU\\SOFTWARE\\Microsoft\\Office\\16.0\\Outlook\\Options\\Mail" /v "EnableLogging" /t REG_DWORD /d 0 /f',
      'reg add "HKCU\\SOFTWARE\\Microsoft\\Office\\15.0\\Outlook\\Options\\Calendar" /v "EnableCalendarLogging" /t REG_DWORD /d 0 /f',
      'reg add "HKCU\\SOFTWARE\\Microsoft\\Office\\16.0\\Outlook\\Options\\Calendar" /v "EnableCalendarLogging" /t REG_DWORD /d 0 /f',
      'reg add "HKCU\\SOFTWARE\\Microsoft\\Office\\15.0\\Word\\Options" /v "EnableLogging" /t REG_DWORD /d 0 /f',
      'reg add "HKCU\\SOFTWARE\\Microsoft\\Office\\16.0\\Word\\Options" /v "EnableLogging" /t REG_DWORD /d 0 /f',
      'reg add "HKCU\\SOFTWARE\\Policies\\Microsoft\\Office\\15.0\\OSM" /v "EnableLogging" /t REG_DWORD /d 0 /f',
      'reg add "HKCU\\SOFTWARE\\Policies\\Microsoft\\Office\\16.0\\OSM" /v "EnableLogging" /t REG_DWORD /d 0 /f',
      'reg add "HKCU\\SOFTWARE\\Policies\\Microsoft\\Office\\15.0\\OSM" /v "EnableUpload" /t REG_DWORD /d 0 /f',
      'reg add "HKCU\\SOFTWARE\\Policies\\Microsoft\\Office\\16.0\\OSM" /v "EnableUpload" /t REG_DWORD /d 0 /f',
      'reg add "HKCU\\SOFTWARE\\Microsoft\\Office\\Common\\ClientTelemetry" /v "DisableTelemetry" /t REG_DWORD /d 1 /f',
      'reg add "HKCU\\SOFTWARE\\Microsoft\\Office\\16.0\\Common\\ClientTelemetry" /v "DisableTelemetry" /t REG_DWORD /d 1 /f',
      'reg add "HKCU\\SOFTWARE\\Microsoft\\Office\\Common\\ClientTelemetry" /v "VerboseLogging" /t REG_DWORD /d 0 /f',
      'reg add "HKCU\\SOFTWARE\\Microsoft\\Office\\16.0\\Common\\ClientTelemetry" /v "VerboseLogging" /t REG_DWORD /d 0 /f',
      'reg add "HKCU\\SOFTWARE\\Microsoft\\Office\\15.0\\Common" /v "QMEnable" /t REG_DWORD /d 0 /f',
      'reg add "HKCU\\SOFTWARE\\Microsoft\\Office\\16.0\\Common" /v "QMEnable" /t REG_DWORD /d 0 /f',
      'reg add "HKCU\\SOFTWARE\\Microsoft\\Office\\15.0\\Common\\Feedback" /v "Enabled" /t REG_DWORD /d 0 /f',
      'reg add "HKCU\\SOFTWARE\\Microsoft\\Office\\16.0\\Common\\Feedback" /v "Enabled" /t REG_DWORD /d 0 /f',
      'Disable-ScheduledTask -TaskName "\\Microsoft\\Office\\OfficeTelemetryAgentFallBack" -ErrorAction SilentlyContinue',
      'Disable-ScheduledTask -TaskName "\\Microsoft\\Office\\OfficeTelemetryAgentLogOn" -ErrorAction SilentlyContinue',
      'Disable-ScheduledTask -TaskName "\\Microsoft\\Office\\OfficeTelemetryAgentFallBack2016" -ErrorAction SilentlyContinue',
      'Disable-ScheduledTask -TaskName "\\Microsoft\\Office\\OfficeTelemetryAgentLogOn2016" -ErrorAction SilentlyContinue',
      'Disable-ScheduledTask -TaskName "\\Microsoft\\Office\\Office 15 Subscription Heartbeat" -ErrorAction SilentlyContinue',
      'Disable-ScheduledTask -TaskName "\\Microsoft\\Office\\Office 16 Subscription Heartbeat" -ErrorAction SilentlyContinue',
    ],
    appexperience: [
      "Write-Host '-- Disabling Application Experience telemetry' -ForegroundColor Green",
      'Disable-ScheduledTask -TaskName "\\Microsoft\\Windows\\Application Experience\\Microsoft Compatibility Appraiser" -ErrorAction SilentlyContinue',
      'Disable-ScheduledTask -TaskName "\\Microsoft\\Windows\\Application Experience\\Microsoft Compatibility Appraiser Exp" -ErrorAction SilentlyContinue',
      'Disable-ScheduledTask -TaskName "\\Microsoft\\Windows\\Application Experience\\StartupAppTask" -ErrorAction SilentlyContinue',
      'Disable-ScheduledTask -TaskName "\\Microsoft\\Windows\\Application Experience\\PcaPatchDbTask" -ErrorAction SilentlyContinue',
      'Disable-ScheduledTask -TaskName "\\Microsoft\\Windows\\Application Experience\\MareBackup" -ErrorAction SilentlyContinue',
    ],
    windowsdrm: [
      "Write-Host '-- Disabling Internet Access to Windows DRM' -ForegroundColor Green",
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\WMDRM" /v "DisableOnline" /t REG_DWORD /d 1 /f',
    ],
    cloudbasedspeech: [
      "Write-Host '-- Disabling Cloud Based Speech Recognition' -ForegroundColor Green",
      'reg add "HKCU\\Software\\Microsoft\\Speech_OneCore\\Settings\\OnlineSpeechPrivacy" /v "HasAccepted" /t REG_DWORD /d 0 /f',
    ],
    wfeedback: [
      "Write-Host '-- Disabling Windows Feedback Experience telemetry' -ForegroundColor Green",
      'reg add "HKCU\\SOFTWARE\\Microsoft\\Siuf\\Rules" /v "NumberOfSIUFInPeriod" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\DataCollection" /v "DoNotShowFeedbackNotifications" /t REG_DWORD /d 1 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\DataCollection" /v "DoNotShowFeedbackNotifications" /t REG_DWORD /d 1 /f',
    ],
    handwriting: [
      "Write-Host '-- Disabling Handwriting telemetry' -ForegroundColor Green",
      'reg add "HKCU\\Software\\Policies\\Microsoft\\InputPersonalization" /v "RestrictImplicitInkCollection" /t REG_DWORD /d 1 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\InputPersonalization" /v "RestrictImplicitInkCollection" /t REG_DWORD /d 1 /f',
      'reg add "HKCU\\Software\\Policies\\Microsoft\\InputPersonalization" /v "RestrictImplicitTextCollection" /t REG_DWORD /d 1 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\InputPersonalization" /v "RestrictImplicitTextCollection" /t REG_DWORD /d 1 /f',
      'reg add "HKCU\\Software\\Policies\\Microsoft\\Windows\\HandwritingErrorReports" /v "PreventHandwritingErrorReports" /t REG_DWORD /d 1 /f',
      'reg add "HKLM\\Software\\Policies\\Microsoft\\Windows\\HandwritingErrorReports" /v "PreventHandwritingErrorReports" /t REG_DWORD /d 1 /f',
      'reg add "HKCU\\Software\\Policies\\Microsoft\\Windows\\TabletPC" /v "PreventHandwritingDataSharing" /t REG_DWORD /d 1 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC" /v "PreventHandwritingDataSharing" /t REG_DWORD /d 1 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\InputPersonalization" /v "AllowInputPersonalization" /t REG_DWORD /d 0 /f',
      'reg add "HKCU\\SOFTWARE\\Microsoft\\InputPersonalization\\TrainedDataStore" /v "HarvestContacts" /t REG_DWORD /d 0 /f',
    ],
    clipboard: [
      "Write-Host '-- Disabling Clipboard history and Cloud Clipboard' -ForegroundColor Green",
      'reg add "HKCU\\Software\\Policies\\Microsoft\\InputPersonalization" /v "RestrictImplicitInkCollection" /t REG_DWORD /d 1 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\InputPersonalization" /v "RestrictImplicitInkCollection" /t REG_DWORD /d 1 /f',
      'reg add "HKCU\\Software\\Policies\\Microsoft\\InputPersonalization" /v "RestrictImplicitTextCollection" /t REG_DWORD /d 1 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\InputPersonalization" /v "RestrictImplicitTextCollection" /t REG_DWORD /d 1 /f',
      'reg add "HKCU\\Software\\Policies\\Microsoft\\Windows\\HandwritingErrorReports" /v "PreventHandwritingErrorReports" /t REG_DWORD /d 1 /f',
      'reg add "HKLM\\Software\\Policies\\Microsoft\\Windows\\HandwritingErrorReports" /v "PreventHandwritingErrorReports" /t REG_DWORD /d 1 /f',
      'reg add "HKCU\\Software\\Policies\\Microsoft\\Windows\\TabletPC" /v "PreventHandwritingDataSharing" /t REG_DWORD /d 1 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\TabletPC" /v "PreventHandwritingDataSharing" /t REG_DWORD /d 1 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\InputPersonalization" /v "AllowInputPersonalization" /t REG_DWORD /d 0 /f',
      'reg add "HKCU\\SOFTWARE\\Microsoft\\InputPersonalization\\TrainedDataStore" /v "HarvestContacts" /t REG_DWORD /d 0 /f',
    ],
    targetads: [
      "Write-Host '-- Disabling Targeted Ads and Data Collection' -ForegroundColor Green",
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\CloudContent" /v "DisableSoftLanding" /t REG_DWORD /d "1" /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\CloudContent" /v "DisableSoftLanding" /t REG_DWORD /d "1" /f',
      'reg add "HKLM\\Software\\Policies\\Microsoft\\Windows\\CloudContent" /v "DisableWindowsSpotlightFeatures" /t "REG_DWORD" /d "1" /f',
      'reg add "HKLM\\Software\\Policies\\Microsoft\\Windows\\CloudContent" /v "DisableWindowsConsumerFeatures" /t "REG_DWORD" /d "1" /f',
      'reg add "HKCU\\Software\\Policies\\Microsoft\\Windows\\CloudContent" /v "DisableTailoredExperiencesWithDiagnosticData" /t "REG_DWORD" /d "1" /f',
      'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\AdvertisingInfo" /v "Enabled" /t REG_DWORD /d "0" /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\AdvertisingInfo" /v "DisabledByGroupPolicy" /t REG_DWORD /d "1" /f',
      'reg add "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\ContentDeliveryManager" /v "SubscribedContent-338393Enabled" /d "0" /t REG_DWORD /f',
      'reg add "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\ContentDeliveryManager" /v "SubscribedContent-353694Enabled" /d "0" /t REG_DWORD /f',
      'reg add "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\ContentDeliveryManager" /v "SubscribedContent-353696Enabled" /d "0" /t REG_DWORD /f',
      'reg add "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\ContentDeliveryManager" /v "SubscribedContent-338387Enabled" /d "0" /t REG_DWORD /f',
      'reg add "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\ContentDeliveryManager" /v "SubscribedContent-338388Enabled" /d "0" /t REG_DWORD /f',
      'reg add "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\ContentDeliveryManager" /v "SubscribedContent-338389Enabled" /d "0" /t REG_DWORD /f',
      'reg add "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\ContentDeliveryManager" /v "SubscribedContent-353698Enabled" /d "0" /t REG_DWORD /f',
    ],
    privacyonsent: [
      "Write-Host '-- Opting out of data collection' -ForegroundColor Green",
      'reg add "HKCU\\SOFTWARE\\Microsoft\\Personalization\\Settings" /v "AcceptedPrivacyPolicy" /t REG_DWORD /d 0 /f',
    ],
    adobetelemetry: [
      "Write-Host '-- Disabling Adobe Telemetry' -ForegroundColor Green",
      "try {",
      '    Invoke-WebRequest -Uri "https://a.dove.isdumb.one/list.txt" -OutFile "$env:TEMP\\list.txt" -ErrorAction Stop',
      '    Write-Host "-- Adobe block entries successfully added to hosts file"',
      '    Get-Content "$env:TEMP\\list.txt" | Add-Content -Path "$env:windir\\System32\\drivers\\etc\\hosts"',
      '    Remove-Item "$env:TEMP\\list.txt" -Force',
      "}",
      "catch {",
      '    Write-Host "-- Failed to download the list from the specified URL." -ForegroundColor Red',
      "}",
    ],
    nvidiatelemetry: [
      "Write-Host '-- Disabling NVIDIA telemetry' -ForegroundColor Green",
      'reg add "HKLM\\SOFTWARE\\NVIDIA Corporation\\NvControlPanel2\\Client" /v "OptInOrOutPreference" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\SOFTWARE\\NVIDIA Corporation\\Global\\FTS" /v "EnableRID44231" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\SOFTWARE\\NVIDIA Corporation\\Global\\FTS" /v "EnableRID64640" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\SOFTWARE\\NVIDIA Corporation\\Global\\FTS" /v "EnableRID66610" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\SYSTEM\\CurrentControlSet\\Services\\nvlddmkm\\Global\\Startup" /v "SendTelemetryData" /t REG_DWORD /d 0 /f',
      'Disable-ScheduledTask -TaskName "NvTmMon_{B2FE1952-0186-46C3-BAEC-A80AA35AC5B8}" -ErrorAction SilentlyContinue',
      'Disable-ScheduledTask -TaskName "NvTmRep_{B2FE1952-0186-46C3-BAEC-A80AA35AC5B8}" -ErrorAction SilentlyContinue',
      'Disable-ScheduledTask -TaskName "NvTmRepOnLogon_{B2FE1952-0186-46C3-BAEC-A80AA35AC5B8}" -ErrorAction SilentlyContinue',
    ],
    vscodetelemetry: [
      "Write-Host '-- Disabling Visual Studio telemetry' -ForegroundColor Green",
      'reg add "HKLM\\SOFTWARE\\Wow6432Node\\Microsoft\\VSCommon\\14.0\\SQM" /v "OptIn" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\SOFTWARE\\Wow6432Node\\Microsoft\\VSCommon\\15.0\\SQM" /v "OptIn" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\SOFTWARE\\Wow6432Node\\Microsoft\\VSCommon\\16.0\\SQM" /v "OptIn" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\SOFTWARE\\Wow6432Node\\Microsoft\\VSCommon\\17.0\\SQM" /v "OptIn" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\Software\\Policies\\Microsoft\\VisualStudio\\SQM" /v "OptIn" /t REG_DWORD /d 0 /f',
      'reg add "HKCU\\Software\\Microsoft\\VisualStudio\\Telemetry" /v "TurnOffSwitch" /t REG_DWORD /d 1 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\VisualStudio\\Feedback" /v "DisableFeedbackDialog" /t REG_DWORD /d 1 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\VisualStudio\\Feedback" /v "DisableEmailInput" /t REG_DWORD /d 1 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\VisualStudio\\Feedback" /v "DisableScreenshotCapture" /t REG_DWORD /d 1 /f',
      'Remove-ItemProperty -Path "HKLM:\\Software\\Microsoft\\VisualStudio\\DiagnosticsHub" -Name "LogLevel" -Force',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\VisualStudio\\IntelliCode" /v "DisableRemoteAnalysis" /t "REG_DWORD" /d "1" /f',
      'reg add "HKCU\\SOFTWARE\\Microsoft\\VSCommon\\16.0\\IntelliCode" /v "DisableRemoteAnalysis" /t "REG_DWORD" /d "1" /f',
      'reg add "HKCU\\SOFTWARE\\Microsoft\\VSCommon\\17.0\\IntelliCode" /v "DisableRemoteAnalysis" /t "REG_DWORD" /d "1" /f',
    ],
    mediatelemetry: [
      "Write-Host '-- Disabling Media Player telemetry' -ForegroundColor Green",
      'reg add "HKCU\\SOFTWARE\\Microsoft\\MediaPlayer\\Preferences" /v "UsageTracking" /t REG_DWORD /d 0 /f',
      'reg add "HKCU\\Software\\Policies\\Microsoft\\WindowsMediaPlayer" /v "PreventCDDVDMetadataRetrieval" /t REG_DWORD /d 1 /f',
      'reg add "HKCU\\Software\\Policies\\Microsoft\\WindowsMediaPlayer" /v "PreventMusicFileMetadataRetrieval" /t REG_DWORD /d 1 /f',
      'reg add "HKCU\\Software\\Policies\\Microsoft\\WindowsMediaPlayer" /v "PreventRadioPresetsRetrieval" /t REG_DWORD /d 1 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\WMDRM" /v "DisableOnline" /t REG_DWORD /d 1 /f',
    ],
    powershelltelemetry: [
      "Write-Host '-- Disabling PowerShell telemetry' -ForegroundColor Green",
      "setx POWERSHELL_TELEMETRY_OPTOUT 1",
    ],
    privacyconsent: [
      "Write-Host '-- Opting out of privacy consent' -ForegroundColor Green",
      'reg add "HKCU\\SOFTWARE\\Microsoft\\Personalization\\Settings" /v "AcceptedPrivacyPolicy" /t REG_DWORD /d 0 /f',
    ],
    ccleanertelemetry: [
      "Write-Host '-- Disabling CCleaner telemetry' -ForegroundColor Green",
      'reg add "HKCU\\Software\\Piriform\\CCleaner" /v "Monitoring" /t REG_DWORD /d 0 /f',
      'reg add "HKCU\\Software\\Piriform\\CCleaner" /v "HelpImproveCCleaner" /t REG_DWORD /d 0 /f',
      'reg add "HKCU\\Software\\Piriform\\CCleaner" /v "SystemMonitoring" /t REG_DWORD /d 0 /f',
      'reg add "HKCU\\Software\\Piriform\\CCleaner" /v "UpdateAuto" /t REG_DWORD /d 0 /f',
      'reg add "HKCU\\Software\\Piriform\\CCleaner" /v "UpdateCheck" /t REG_DWORD /d 0 /f',
      'reg add "HKCU\\Software\\Piriform\\CCleaner" /v "CheckTrialOffer" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\Software\\Piriform\\CCleaner" /v "(Cfg)HealthCheck" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\Software\\Piriform\\CCleaner" /v "(Cfg)QuickClean" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\Software\\Piriform\\CCleaner" /v "(Cfg)QuickCleanIpm" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\Software\\Piriform\\CCleaner" /v "(Cfg)GetIpmForTrial" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\Software\\Piriform\\CCleaner" /v "(Cfg)SoftwareUpdater" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\Software\\Piriform\\CCleaner" /v "(Cfg)SoftwareUpdaterIpm" /t REG_DWORD /d 0 /f',
    ],
    adobeupdates: [
      "Write-Host '-- Disabling Adobe updates' -ForegroundColor Green",
      'Disable-ScheduledTask -TaskName "\\Adobe Acrobat Update Task" -ErrorAction SilentlyContinue',
      'Set-Service -Name "AdobeARMservice" -StartupType Disabled',
      'Set-Service -Name "adobeupdateservice" -StartupType Disabled',
    ],
    defaultupdate: [
      "Write-Host '-- Restoring default Windows Update settings' -ForegroundColor Green",
      'Remove-Item -Path "HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU" -Recurse -Force',
      'Remove-Item -Path "HKLM:\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\DeliveryOptimization" -Recurse -Force',
      'Remove-Item -Path "HKLM:\\SOFTWARE\\Microsoft\\WindowsUpdate\\UX\\Settings" -Recurse -Force',
      'Remove-Item -Path "HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\Device Metadata" -Recurse -Force',
      'Remove-Item -Path "HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\DriverSearching" -Recurse -Force',
      'Remove-Item -Path "HKLM:\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate" -Recurse -Force',
      'Write-Host "-- Re-enabling WU services"',
      'Set-Service -Name "bits" -StartupType Manual',
      'Set-Service -Name "wuauserv" -StartupType Manual',
      'Set-Service -Name "usosvc" -StartupType Automatic',
      'Set-Service -Name "WaaSMedicSvc" -StartupType Manual',
      'Write-Host -- "Re-enabling WU scheduled tasks"',
      `$paths = @('\\Microsoft\\Windows\\InstallService\\', '\\Microsoft\\Windows\\UpdateOrchestrator\\', '\\Microsoft\\Windows\\UpdateAssistant\\', '\\Microsoft\\Windows\\WaaSMedic\\', '\\Microsoft\\Windows\\WindowsUpdate\\', '\\Microsoft\\WindowsUpdate\\'); foreach ($path in $paths) { Get-ScheduledTask -TaskPath "$path*" -ErrorAction SilentlyContinue | Enable-ScheduledTask -ErrorAction SilentlyContinue }`,
      'Write-Host -- "Resetting Windows local security policies to default"',
      'secedit /configure /cfg "$Env:SystemRoot\\inf\\defltbase.inf" /db defltbase.sdb',
    ],
    securityupdate: [
      "Write-Host '-- Delaying feature updates by 1 year' -ForegroundColor Green",
      'reg add "HKLM\\SOFTWARE\\Microsoft\\WindowsUpdate\\UX\\Settings" /f',
      'reg add "HKLM\\SOFTWARE\\Microsoft\\WindowsUpdate\\UX\\Settings" /v "BranchReadinessLevel" /t REG_DWORD /d "20" /f',
      'reg add "HKLM\\SOFTWARE\\Microsoft\\WindowsUpdate\\UX\\Settings" /v "DeferFeatureUpdatesPeriodInDays" /t REG_DWORD /d "365" /f',
    ],
    disableupdate: [
      "Write-Host '-- Disabling Windows Update' -ForegroundColor Green",
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU" /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU" /v "NoAutoUpdate" /t REG_DWORD /d "1" /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU" /v "AUOptions" /t REG_DWORD /d "1" /f',
      'reg add "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\DeliveryOptimization\\Config" /f',
      'reg add "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\DeliveryOptimization\\Config" /v "DODownloadMode" /t REG_DWORD /d "0" /f',
      'Write-Host "-- Disabling Windows Update Services"',
      '$updateServices = @("BITS","wuauserv","UsoSvc","WaaSMedicSvc")',
      "$updateServices | ForEach-Object { Stop-Service -Name $_; Set-Service -Name $_ -StartupType Disabled }",
      'Remove-Item -Path "C:\\Windows\\SoftwareDistribution" -Recurse -Force',
      'Write-Host -- "Disabling Windows Update Scheduled Tasks"',
      `$paths = @('\\Microsoft\\Windows\\InstallService\\', '\\Microsoft\\Windows\\UpdateOrchestrator\\', '\\Microsoft\\Windows\\UpdateAssistant\\', '\\Microsoft\\Windows\\WaaSMedic\\', '\\Microsoft\\Windows\\WindowsUpdate\\', '\\Microsoft\\WindowsUpdate\\'); foreach ($path in $paths) { Get-ScheduledTask -TaskPath "$path*" -ErrorAction SilentlyContinue | Disable-ScheduledTask -ErrorAction SilentlyContinue }`,
    ],
    googleupdates: [
      "Write-Host '-- Disabling Google updates' -ForegroundColor Green",
      'Set-Service -Name "gupdate" -StartupType Disabled',
      'Set-Service -Name "gupdatem" -StartupType Disabled',
    ],
    locationaccess: [
      "Write-Host '-- Disabling Location access' -ForegroundColor Green",
      'reg add "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\CapabilityAccessManager\\ConsentStore\\location" /v "Value" /d "Deny" /f',
    ],
    cameraccess: [
      "Write-Host '-- Disabling Camera access' -ForegroundColor Green",
      'reg add "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\CapabilityAccessManager\\ConsentStore\\webcam" /v "Value" /d "Deny" /t REG_SZ /f',
    ],
    microphoneaccess: [
      "Write-Host '-- Disabling Microphone access' -ForegroundColor Green",
      'reg add "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\CapabilityAccessManager\\ConsentStore\\microphone" /v "Value" /d "Deny" /t REG_SZ /f',
    ],
    systemaccess: [
      "Write-Host '-- Disabling System files access' -ForegroundColor Green",
      'reg add "HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\CapabilityAccessManager\\ConsentStore\\documentsLibrary" /v "Value" /d "Deny" /t REG_SZ /f',
      'reg add "HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\CapabilityAccessManager\\ConsentStore\\picturesLibrary" /v "Value" /d "Deny" /t REG_SZ /f',
      'reg add "HKLM\\Software\\Microsoft\\Windows\\CurrentVersion\\CapabilityAccessManager\\ConsentStore\\videosLibrary" /v "Value" /d "Deny" /t REG_SZ /f',
      'reg add "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\CapabilityAccessManager\\ConsentStore\\broadFileSystemAccess" /v "Value" /d "Deny" /t REG_SZ /f',
    ],
    accinfoaccess: [
      "Write-Host '-- Disabling Account Information access' -ForegroundColor Green",
      'reg add "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\CapabilityAccessManager\\ConsentStore\\userAccountInformation" /v "Value" /d "Deny" /f',
    ],
    contactsaccess: [
      "Write-Host '-- Disabling Contacts access' -ForegroundColor Green",
      'reg add "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\CapabilityAccessManager\\ConsentStore\\contacts" /v "Value" /d "Deny" /t REG_SZ /f',
    ],
    callhistoryaccess: [
      "Write-Host '-- Disabling Call History access' -ForegroundColor Green",
      'reg add "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\CapabilityAccessManager\\ConsentStore\\phoneCallHistory" /v "Value" /d "Deny" /t REG_SZ /f',
    ],
    messagingaccess: [
      "Write-Host '-- Disabling Messaging access' -ForegroundColor Green",
      'reg add "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\CapabilityAccessManager\\ConsentStore\\chat" /v "Value" /d "Deny" /t REG_SZ /f',
    ],
    notificationaccess: [
      "Write-Host '-- Disabling Notification access' -ForegroundColor Green",
      'reg add "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\CapabilityAccessManager\\ConsentStore\\userNotificationListener" /v "Value" /d "Deny" /t REG_SZ /f',
    ],
    emailaccess: [
      "Write-Host '-- Disabling Email access' -ForegroundColor Green",
      'reg add "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\CapabilityAccessManager\\ConsentStore\\email" /v "Value" /d "Deny" /t REG_SZ /f',
    ],
    tasksaccess: [
      "Write-Host '-- Disabling Tasks access' -ForegroundColor Green",
      'reg add "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\CapabilityAccessManager\\ConsentStore\\userDataTasks" /v "Value" /d "Deny" /t REG_SZ /f',
    ],
    diagaccess: [
      "Write-Host '-- Disabling Diagnostics access' -ForegroundColor Green",
      'reg add "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\CapabilityAccessManager\\ConsentStore\\appDiagnostics" /v "Value" /d "Deny" /t REG_SZ /f',
    ],
    voiceactivationaccess: [
      "Write-Host '-- Disabling Voice Activation access' -ForegroundColor Green",
      'reg add "HKCU\\Software\\Microsoft\\Speech_OneCore\\Settings\\VoiceActivation\\UserPreferenceForAllApps" /v "AgentActivationEnabled" /t REG_DWORD /d 0 /f',
    ],
    phoneaccess: [
      "Write-Host '-- Disabling Phone access' -ForegroundColor Green",
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\AppPrivacy" /v "LetAppsAccessPhone" /t REG_DWORD /d 2 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\AppPrivacy" /v "LetAppsAccessPhone_UserInControlOfTheseApps" /t REG_MULTI_SZ /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\AppPrivacy" /v "LetAppsAccessPhone_ForceAllowTheseApps" /t REG_MULTI_SZ /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\AppPrivacy" /v "LetAppsAccessPhone_ForceDenyTheseApps" /t REG_MULTI_SZ /f',
    ],
    trustedaccess: [
      "Write-Host '-- Disabling Trusted Devices access' -ForegroundColor Green",
      'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\DeviceAccess\\Global\\{C1D23ACC-752B-43E5-8448-8D0E519CD6D6}" /t REG_SZ /v "Value" /d "Deny" /f',
    ],
    calendaraccess: [
      "Write-Host '-- Disabling Calendar access' -ForegroundColor Green",
      'reg add "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\CapabilityAccessManager\\ConsentStore\\appointments" /v "Value" /d "Deny" /t REG_SZ /f',
    ],
    motionaccess: [
      "Write-Host '-- Disabling Motion access' -ForegroundColor Green",
      'reg add "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\CapabilityAccessManager\\ConsentStore\\activity" /v "Value" /d "Deny" /f',
    ],
    radioaccess: [
      "Write-Host '-- Disabling Radio access' -ForegroundColor Green",
      'reg add "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\CapabilityAccessManager\\ConsentStore\\radios" /v "Value" /d "Deny" /t REG_SZ /f',
    ],
    screenshotborderaccess: [
      "Write-Host '-- Disabling Screenshot Borders access' -ForegroundColor Green",
      'reg add "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\CapabilityAccessManager\\ConsentStore\\graphicsCaptureWithoutBorder" /v "Value" /d "Deny" /t REG_SZ /f',
    ],
    recordingsaccess: [
      "Write-Host '-- Disabling Recordings access' -ForegroundColor Green",
      'reg add "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\CapabilityAccessManager\\ConsentStore\\graphicsCaptureProgrammatic" /v "Value" /d "Deny" /t REG_SZ /f',
    ],
    aigenerationaccess: [
      "Write-Host '-- Disabling AI Generation access' -ForegroundColor Green",
      'reg add "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\CapabilityAccessManager\\ConsentStore\\systemAIModels" /v "Value" /d "Deny" /t REG_SZ /f',
    ],
    updatepause: [
      "Write-Host '-- Extend Windows Update Pause Limit to 20 years' -ForegroundColor Green",
      'Write-Host "-- NOTE: This does not disable updates by itself, user needs to pause updates in Windows Settings." -ForegroundColor Yellow',
      'reg add "HKLM\\SOFTWARE\\Microsoft\\WindowsUpdate\\UX\\Settings" /v "FlightSettingsMaxPauseDays" /t REG_DWORD /d 7300 /f',
    ],
    cloudsync: [
      "Write-Host '-- Disabling Cloud Sync' -ForegroundColor Green",
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\SettingSync" /v "DisableSettingSync" /t REG_DWORD /d 2 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\SettingSync" /v "DisableSettingSyncUserOverride" /t REG_DWORD /d 1 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\SettingSync" /v "DisableSyncOnPaidNetwork" /t REG_DWORD /d 1 /f',
      'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\SettingSync" /v "SyncPolicy" /t REG_DWORD /d 5 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\SettingSync" /v "DisableApplicationSettingSync" /t REG_DWORD /d 2 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\SettingSync" /v "DisableApplicationSettingSyncUserOverride" /t REG_DWORD /d 1 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\SettingSync" /v "DisableAppSyncSettingSync" /t REG_DWORD /d 2 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\SettingSync" /v "DisableAppSyncSettingSyncUserOverride" /t REG_DWORD /d 1 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\SettingSync" /v "DisableCredentialsSettingSync" /t REG_DWORD /d 2 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\SettingSync" /v "DisableCredentialsSettingSyncUserOverride" /t REG_DWORD /d 1 /f',
      'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\SettingSync\\Groups\\Credentials" /v "Enabled" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\SettingSync" /v "DisableDesktopThemeSettingSync" /t REG_DWORD /d 2 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\SettingSync" /v "DisableDesktopThemeSettingSyncUserOverride" /t REG_DWORD /d 1 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\SettingSync" /v "DisablePersonalizationSettingSync" /t REG_DWORD /d 2 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\SettingSync" /v "DisablePersonalizationSettingSyncUserOverride" /t REG_DWORD /d 1 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\SettingSync" /v "DisableStartLayoutSettingSync" /t REG_DWORD /d 2 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\SettingSync" /v "DisableStartLayoutSettingSyncUserOverride" /t REG_DWORD /d 1 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\SettingSync" /v "DisableWebBrowserSettingSync" /t REG_DWORD /d 2 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\SettingSync" /v "DisableWebBrowserSettingSyncUserOverride" /t REG_DWORD /d 1 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\SettingSync" /v "DisableWebBrowserSettingSync" /t REG_DWORD /d 2 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\SettingSync" /v "DisableWebBrowserSettingSyncUserOverride" /t REG_DWORD /d 1 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\SettingSync" /v "DisableWindowsSettingSync" /t REG_DWORD /d 2 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\SettingSync" /v "DisableWindowsSettingSyncUserOverride" /t REG_DWORD /d 1 /f',
      'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\SettingSync\\Groups\\Language" /t REG_DWORD /v "Enabled" /d 0 /f',
    ],
    activityfeed: [
      "Write-Host '-- Disabling Activity Feed' -ForegroundColor Green",
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\System" /v "EnableActivityFeed" /d "0" /t REG_DWORD /f',
    ],
    notificationtray: [
      "Write-Host '-- Disabling Notification Tray' -ForegroundColor Green",
      'reg add "HKCU\\Software\\Policies\\Microsoft\\Windows\\Explorer" /v "DisableNotificationCenter" /d "1" /t REG_DWORD /f',
    ],
    screenrecording: [
      "Write-Host '-- Disabling Xbox Screen Recording' -ForegroundColor Green",
      'reg add "HKCU\\System\\GameConfigStore" /v "GameDVR_Enabled" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\GameDVR" /v "AllowGameDVR" /t REG_DWORD /d 0 /f',
    ],
    automap: [
      "Write-Host '-- Disabling Auto Map Downloads' -ForegroundColor Green",
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Maps" /v "AllowUntriggeredNetworkTrafficOnSettingsPage" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Maps" /v "AutoDownloadAndUpdateMapData" /t REG_DWORD /d 0 /f',
    ],
    default0user: [
      "Write-Host '-- Deleting Default0 User' -ForegroundColor Green",
      'Remove-LocalUser -Name "defaultuser0"',
    ],
    lockscreencamera: [
      "Write-Host '-- Disabling Lock Screen Camera' -ForegroundColor Green",
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Personalization" /v "NoLockScreenCamera" /t REG_DWORD /d 1 /f',
    ],
    biometrics: [
      "Write-Host '-- Disabling Biometrics (Breaks Windows Hello)' -ForegroundColor Green",
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Biometrics" /v "Enabled" /t REG_DWORD /d "0" /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Biometrics\\Credential Provider" /v "Enabled" /t "REG_DWORD" /d "0" /f',
    ],

    googledns: [
      "Write-Host '-- Setting Google DNS' -ForegroundColor Green",
      'netsh interface ip set dns name="Ethernet" static 8.8.8.8 | Out-Null',
      'netsh interface ip add dns name="Ethernet" 8.8.4.4 index=2 | Out-Null',
    ],
    cloudflaredns: [
      "Write-Host '-- Setting Cloudflare DNS' -ForegroundColor Green",
      'netsh interface ip set dns name="Ethernet" static 1.1.1.1 | Out-Null',
      'netsh interface ip add dns name="Ethernet" 1.0.0.1 index=2 | Out-Null',
    ],
    quad9dns: [
      "Write-Host '-- Setting Quad9 DNS' -ForegroundColor Green",
      'netsh interface ip set dns name="Ethernet" static 9.9.9.9 | Out-Null',
      'netsh interface ip add dns name="Ethernet" 149.112.112.112 index=2 | Out-Null',
    ],
    opendns: [
      "Write-Host '-- Setting OpenDNS DNS' -ForegroundColor Green",
      'netsh interface ip set dns name="Ethernet" static 208.67.222.222 | Out-Null',
      'netsh interface ip add dns name="Ethernet" 208.67.220.220 index=2 | Out-Null',
    ],
    adguard: [
      "Write-Host '-- Setting AdGuard DNS' -ForegroundColor Green",
      'netsh interface ip set dns name="Ethernet" static 94.140.14.14 | Out-Null',
      'netsh interface ip add dns name="Ethernet" 94.140.15.15 index=2 | Out-Null',
    ],

    cleantemp: [
      "Write-Host '-- Deleting Temp files' -ForegroundColor Green",
      'Remove-Item -Path "C:\\Windows\\Temp\\*" -Recurse -Force',
      'Remove-Item -Path "C:\\Windows\\Prefetch\\*" -Recurse -Force',
    ],
    cleanmgr: [
      "Write-Host '-- Running Disk Clean-up' -ForegroundColor Green",
      "cleanmgr /verylowdisk /sagerun:5",
    ],
    emptyrecycle: [
      "Write-Host '-- Emptying Recycle Bin' -ForegroundColor Green",
      `$bin = (New-Object -ComObject Shell.Application).NameSpace(10); $bin.items() | ForEach { Write-Host "Deleting $($_.Name) from Recycle Bin"; Remove-Item $_.Path -Recurse -Force }`,
    ],
    browserhistory: [
      "Write-Host '-- Clearing Browser History' -ForegroundColor Green",
      'Remove-Item -Path "$env:LocalAppData\\Google\\Chrome\\User Data\\Default\\History" -Recurse -Force',
      'Remove-Item -Path "$env:LocalAppData\\Google\\Chrome\\User Data\\Default\\Cache\\*" -Recurse -Force',
      'Remove-Item -Path "$env:LocalAppData\\Google\\Chrome\\User Data\\Default\\Cookies" -Recurse -Force',
      'Remove-Item -Path "$env:LocalAppData\\Microsoft\\Edge\\User Data\\Default\\History" -Recurse -Force',
      'Remove-Item -Path "$env:LocalAppData\\Microsoft\\Edge\\User Data\\Default\\Cache\\*" -Recurse -Force',
      'Remove-Item -Path "$env:LocalAppData\\Microsoft\\Edge\\User Data\\Default\\Cookies" -Recurse -Force',
      'Remove-Item -Path "$env:AppData\\Mozilla\\Firefox\\Profiles\\*.default\\places.sqlite" -Recurse -Force',
      'Remove-Item -Path "$env:AppData\\Mozilla\\Firefox\\Profiles\\*.default\\cache2\\entries\\*" -Recurse -Force',
      'Remove-Item -Path "$env:LocalAppData\\BraveSoftware\\Brave-Browser\\User Data\\Default\\History" -Recurse -Force',
      'Remove-Item -Path "$env:LocalAppData\\BraveSoftware\\Brave-Browser\\User Data\\Default\\Cache\\*" -Recurse -Force',
      'Remove-Item -Path "$env:LocalAppData\\BraveSoftware\\Brave-Browser\\User Data\\Default\\Cookies" -Recurse -Force',
    ],
    sfc: ["Write-Host '-- Running SFC' -ForegroundColor Green", "sfc /scannow"],
    dism: [
      "Write-Host '-- Running DISM' -ForegroundColor Green",
      "DISM /Online /Cleanup-Image /RestoreHealth",
    ],
    resetnetwork: [
      "Write-Host '-- Resetting Network' -ForegroundColor Green",
      "ipconfig /flushdns",
      "ipconfig /release | Out-Null",
      "ipconfig /renew | Out-Null",
    ],
    balanced: [
      "Write-Host '-- Set Balanced Power Plan' -ForegroundColor Green",
      `$balanced = powercfg -list | Select-String -Pattern 'Balanced'; if ($balanced) { Write-Host '-- Power plan already exists.' } else { Write-Host '-- Enabling Balanced.'; $output = powercfg -duplicatescheme 381b4222-f694-41f0-9685-ff5bb260df2e 2>&1; if ($output -match 'Unable to create a new power scheme' -or $output -match 'The power scheme, subgroup or setting specified does not exist') { powercfg -RestoreDefaultSchemes } }`,
      `$balancedGUID = (powercfg -list | Select-String -Pattern 'Balanced').Line.Split()[3]; Write-Host '-- Activating Balanced'; powercfg -setactive $balancedGUID`,
    ],
    highperformance: [
      "Write-Host '-- Set High Performance Power Plan' -ForegroundColor Green",
      `$highPerformance = powercfg -list | Select-String -Pattern 'High performance'; if ($highPerformance) { Write-Host '-- Power plan already exists.' } else { Write-Host '-- Enabling High Performance.'; $output = powercfg -duplicatescheme 8c5e7fda-e8bf-4a96-9a85-a6e23a8c635c 2>&1; if ($output -match 'Unable to create a new power scheme' -or $output -match 'The power scheme, subgroup or setting specified does not exist') { powercfg -RestoreDefaultSchemes } }`,
      `$highPlanGUID = (powercfg -list | Select-String -Pattern 'High performance').Line.Split()[3]; Write-Host '-- Activating High Performance'; powercfg -setactive $highPlanGUID`,
    ],
    ultimateperformance: [
      "Write-Host '-- Set Ultimate Performance Power Plan' -ForegroundColor Green",
      `$ultimatePerformance = powercfg -list | Select-String -Pattern 'Ultimate Performance'; if ($ultimatePerformance) { Write-Host '-- Power plan already exists.' } else { Write-Host '-- Enabling Ultimate Performance.'; $output = powercfg -duplicatescheme e9a42b02-d5df-448d-aa00-03f14749eb61 2>&1; if ($output -match 'Unable to create a new power scheme' -or $output -match 'The power scheme, subgroup or setting specified does not exist') { powercfg -RestoreDefaultSchemes } }`,
      `$ultimatePlanGUID = (powercfg -list | Select-String -Pattern 'Ultimate Performance').Line.Split()[3]; Write-Host '-- Activating Ultimate Performance'; powercfg -setactive $ultimatePlanGUID`,
    ],
    transparency: [
      "Write-Host '-- Disabling Transparency' -ForegroundColor Green",
      'reg add "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Themes\\Personalize" /v "EnableTransparency" /t REG_DWORD /d 0 /f',
    ],
    manualservices: [
      "Write-Host '-- Disabling Manual Services' -ForegroundColor Green",
      '$manualServices = @("ALG","AppMgmt","AppReadiness","Appinfo","AxInstSV","BDESVC","BTAGService","BcastDVRUserService","BluetoothUserService","Browser","CDPSvc","COMSysApp","CaptureService","CertPropSvc","ConsentUxUserSvc","CscService","DevQueryBroker","DeviceAssociationService","DeviceInstall","DevicePickerUserSvc","DevicesFlowUserSvc","DisplayEnhancementService","DmEnrollmentSvc","DsSvc","DsmSvc","EFS","EapHost","EntAppSvc","FDResPub","FrameServer","FrameServerMonitor","GraphicsPerfSvc","HvHost","IEEtwCollectorService","InstallService","InventorySvc","IpxlatCfgSvc","KtmRm","LicenseManager","LxpSvc","MSDTC","MSiSCSI","McpManagementService","MicrosoftEdgeElevationService","MsKeyboardFilter","NPSMSvc","NaturalAuthentication","NcaSvc","NcbService","NcdAutoSetup","NetSetupSvc","Netman","NgcCtnrSvc","NgcSvc","NlaSvc","PNRPAutoReg","PcaSvc","PeerDistSvc","PenService","PerfHost","PhoneSvc","PimIndexMaintenanceSvc","PlugPlay","PolicyAgent","PrintNotify","PushToInstall","QWAVE","RasAuto","RasMan","RetailDemo","RmSvc","RpcLocator","SCPolicySvc","SCardSvr","SDRSVC","SEMgrSvc","SNMPTRAP","SNMPTrap","SSDPSRV","ScDeviceEnum","SensorDataService","SensorService","SensrSvc","SessionEnv","SharedAccess","SmsRouter","SstpSvc","StiSvc","StorSvc","TapiSrv","TextInputManagementService","TieringEngineService","TokenBroker","TroubleshootingSvc","TrustedInstaller","UdkUserSvc","UmRdpService","UserDataSvc","UsoSvc","VSS","VacSvc","WEPHOSTSVC","WFDSConMgrSvc","WMPNetworkSvc","WManSvc","WPDBusEnum","WalletService","WarpJITSvc","WbioSrvc","WdNisSvc","WdiServiceHost","WdiSystemHost","WebClient","Wecsvc","WerSvc","WiaRpc","WinRM","WpcMonSvc","WpnService","WwanSvc","autotimesvc","bthserv","camsvc","cbdhsvc","cloudidsvc","dcsvc","defragsvc","diagsvc","dmwappushservice","dot3svc","edgeupdate","edgeupdatem","embeddedmode","fdPHost","fhsvc","hidserv","icssvc","lfsvc","lltdsvc","lmhosts","msiserver","netprofm","p2pimsvc","p2psvc","perceptionsimulation","pla","seclogon","smphost","svsvc","swprv","upnphost","vds","vmicguestinterface","vmicheartbeat","vmickvpexchange","vmicrdv","vmicshutdown","vmictimesync","vmicvmsession","vmicvss","vmvss","wbengine","wcncsvc","webthreatdefsvc","wercplsupport","wisvc","wlidsvc","wlpasvc","wmiApSrv","workfolderssvc","wuauserv","wudfsvc")',
      '$disabledServices = @("AppVClient","AssignedAccessManagerSvc","DiagTrack","DialogBlockingService","NetTcpPortSharing","RemoteAccess","RemoteRegistry","shpamsvc","ssh-agent","tzautoupdate")',
      "$manualServices | ForEach-Object { Set-Service -Name $_ -StartupType Manual }",
      "$disabledServices | ForEach-Object { Set-Service -Name $_ -StartupType Disabled }",
    ],
    mousedelay: [
      "Write-Host '-- Disabling Mouse Delay Times' -ForegroundColor Green",
      'reg add "HKCU\\Control Panel\\Desktop" /v "MenuShowDelay" /t REG_SZ /d 0 /f',
      'reg add "HKCU\\Control Panel\\Mouse" /v "MouseHoverTime" /t REG_SZ /d 0 /f',
    ],
    hags: [
      "Write-Host '-- Disabling HAGS' -ForegroundColor Green",
      'reg add "HKLM\\SYSTEM\\CurrentControlSet\\Control\\GraphicsDrivers" /v "HwSchMode" /t REG_DWORD /d 1 /f',
    ],
    storagesense: [
      "Write-Host '-- Disabling Storage Sense' -ForegroundColor Green",
      'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\StorageSense\\Parameters\\StoragePolicy" /v "01" /t REG_DWORD /d 0 /f',
    ],
    disablehibernation: [
      "Write-Host '-- Disabling Hibernation' -ForegroundColor Green",
      "powercfg /h off",
    ],
    limitdefender: [
      "Write-Host '-- Limiting Windows Defender Usage' -ForegroundColor Green",
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Scan" /v "AvgCPULoadFactor" /t REG_DWORD /d "25" /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows Defender\\Scan" /v "ScanAvgCPULoadFactor" /t REG_DWORD /d "25" /f',
    ],
    coreisolation: [
      "Write-Host '-- Disabling Core Isolation' -ForegroundColor Green",
      'reg add "HKLM\\System\\CurrentControlSet\\Control\\DeviceGuard\\Scenarios\\HypervisorEnforcedCodeIntegrity" /v "Enabled" /t REG_DWORD /d 0 /f',
    ],
    disableprefetch: [
      "Write-Host '-- Disabling Prefetch' -ForegroundColor Green",
      'Stop-Service -Name "sysmain"',
      'Set-Service -Name "sysmain" -StartupType Disabled',
    ],
    darkmode: [
      "Write-Host '-- Enabling Dark Mode' -ForegroundColor Green",
      'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Themes\\Personalize" /v "AppsUseLightTheme" /t REG_DWORD /d 0 /f',
      'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Themes\\Personalize" /v "SystemUsesLightTheme" /t REG_DWORD /d 0 /f',
    ],
    filextensions: [
      "Write-Host '-- Showing File Extensions' -ForegroundColor Green",
      'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced" /v "HideFileExt" /t REG_DWORD /d 0 /f',
    ],
    fullscreenoptimizations: [
      "Write-Host '-- Disabling Fullscreen Optimizations' -ForegroundColor Green",
      'reg add "HKCU\\System\\GameConfigStore" /v "GameDVR_DXGIHonorFSEWindowsCompatible" /t REG_DWORD /d 1 /f',
    ],
    mouseacc: [
      "Write-Host '-- Disabling Mouse Acceleration' -ForegroundColor Green",
      'reg add "HKCU\\Control Panel\\Mouse" /v "MouseSpeed" /t REG_SZ /d "0" /f',
      'reg add "HKCU\\Control Panel\\Mouse" /v "MouseThreshold1" /t REG_SZ /d "0" /f',
      'reg add "HKCU\\Control Panel\\Mouse" /v "MouseThreshold2" /t REG_SZ /d "0" /f',
    ],
    gamemode: [
      "Write-Host '-- Disabling Game Mode' -ForegroundColor Green",
      'reg add "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\GameDVR" /v "AutoGameModeEnabled" /t REG_DWORD /d 0 /f',
      'reg add "HKCU\\SOFTWARE\\Microsoft\\GameBar" /v "AutoGameModeEnabled" /t REG_DWORD /d 0 /f',
    ],
    gamebar: [
      "Write-Host '-- Disabling Game Bar' -ForegroundColor Green",
      'reg add "HKLM\\SOFTWARE\\Polices\\Microsoft\\Windows\\GameDVR" /v "AllowGameDVR" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\GameDVR" /v "AppCaptureEnabled" /t REG_DWORD /d 0 /f',
      'reg add "HKCU\\SOFTWARE\\Microsoft\\GameBar" /v "UseNexusForGameBarEnabled" /t REG_DWORD /d 0 /f',
      'reg add "HKCU\\SOFTWARE\\Microsoft\\GameBar" /v "ShowStartupPanel" /t REG_DWORD /d 0 /f',
    ],
    classicmenu: [
      "Write-Host '-- Setting Classic Right-Click Menu' -ForegroundColor Green",
      'reg add "HKCU\\Software\\Classes\\CLSID\\{86ca1aa0-34aa-4e8b-a509-50c905bae2a2}\\InprocServer32" /f /ve',
    ],
    endtask: [
      "Write-Host '-- Adding End Task to Right-Click' -ForegroundColor Green",
      'reg add "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced\\TaskbarDeveloperSettings" /v "TaskbarEndTask" /t REG_DWORD /d "1" /f',
    ],
    mpo: [
      "Write-Host '-- Disabling Multiplane Overlay (MPO)' -ForegroundColor Green",
      'reg add "HKLM\\SOFTWARE\\Microsoft\\Windows\\Dwm" /v "OverlayTestMode" /t REG_DWORD /d "00000005" /f',
    ],
    taskbarleft: [
      "Write-Host '-- Moving Taskbar Icons to the left' -ForegroundColor Green",
      'reg add "HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced" /v TaskbarAl /t REG_DWORD /d 0 /f',
    ],
    stickykeys: [
      "Write-Host '-- Disabling Sticky Keys' -ForegroundColor Green",
      'reg add "HKCU\\Control Panel\\Accessibility\\StickyKeys" /v "Flags" /t REG_SZ /d "58" /f',
    ],
    taskbarwidgets: [
      "Write-Host '-- Disabling Taskbar Widgets' -ForegroundColor Green",
      // TaskbarDa is blocked by Windows 11 24H2
      // 'reg add "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced" /v "TaskbarDa" /t REG_DWORD /d 0 /f',
      'reg add "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced" /v "ShowTaskViewButton" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\SOFTWARE\\Microsoft\\PolicyManager\\default\\NewsAndInterests\\AllowNewsAndInterests" /v "value" /t REG_DWORD /d 0 /f',
      'reg add "HKLM\\SOFTWARE\\Policies\\Microsoft\\Windows\\Windows Feeds" /v "EnableFeeds" /t REG_DWORD /d 0 /f',
    ],
    numlockstartup: [
      "Write-Host '-- Disabling Num Lock on Startup' -ForegroundColor Green",
      'reg add "HKCU\\Control Panel\\Keyboard" /v "InitialKeyboardIndicators" /t REG_SZ /d "0" /f',
    ],
    snapflyout: [
      "Write-Host '-- Disabling Snap Assist Flyout' -ForegroundColor Green",
      'reg add "HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Explorer\\Advanced" /v "EnableSnapAssistFlyout" /t REG_DWORD /d 0 /f',
    ],
    detailedbsod: [
      "Write-Host '-- Enabling Detailed BSOD' -ForegroundColor Green",
      'reg add "HKLM\\System\\CurrentControlSet\\Control\\CrashControl" /v "DisplayParameters" /t REG_DWORD /d 1 /f',
    ],
    verboselogon: [
      "Write-Host '-- Enabling Verbose Logon' -ForegroundColor Green",
      'reg add "HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System" /v "VerboseStatus" /t REG_DWORD /d 1 /f',
    ],
  };

  const checkboxItems = [
    "microsoftstore",
    "msstoreupdates",
    "onedrive",
    "debloatedge",
    "edge",
    "copilot",
    "widgets",
    "taskbarwidgets",
    "thirdparty",
    "extensions",
    "msapps",
    "xbox",
    "consumerfeatures",
    "recall",
    "notepadrewrite",
    "aiappxpackages",
    "hideai",
    "aifiles",
    "iexplorer",
    "hyperv",
    "faxscan",
    "mediaplayer",
    "wsearch",
    "wtelemetry",
    "wupdate",
    "wsearchtelemetry",
    "officetelemetry",
    "appexperience",
    "windowsdrm",
    "cloudbasedspeech",
    "wfeedback",
    "handwriting",
    "clipboard",
    "targetads",
    "privacyconsent",

    "adobetelemetry",
    "nvidiatelemetry",
    "vscodetelemetry",
    "mediatelemetry",
    "powershelltelemetry",
    "ccleanertelemetry",
    "googleupdates",
    "adobeupdates",
    "defaultupdate",
    "securityupdate",
    "disableupdate",

    "locationaccess",
    "cameraccess",
    "microphoneaccess",
    "systemaccess",
    "accinfoaccess",
    "contactsaccess",
    "callhistoryaccess",
    "messagingaccess",
    "notificationaccess",
    "emailaccess",
    "tasksaccess",
    "diagaccess",
    "voiceactivationaccess",
    "phoneaccess",
    "trustedaccess",
    "calendaraccess",
    "motionaccess",
    "radioaccess",
    "screenshotborderaccess",
    "recordingsaccess",
    "aigenerationaccess",
    "updatepause",
    "cloudsync",
    "notificationtray",
    "activityfeed",
    "screenrecording",
    "automap",
    "default0user",
    "lockscreencamera",
    "biometrics",

    "googledns",
    "cloudflaredns",
    "quad9dns",
    "opendns",
    "adguardns",

    "cleantemp",
    "cleanmgr",
    "emptyrecycle",
    "browserhistory",
    "sfc",
    "dism",
    "resetnetwork",

    "balanced",
    "highperformance",
    "ultimateperformance",
    "manualservices",
    "transparency",
    "mousedelay",
    "hags",
    "storagesense",
    "disablehibernation",
    "limitdefender",
    "coreisolation",
    "disableprefetch",

    "fullscreenoptimizations",
    "mouseacc",
    "gamemode",
    "gamebar",

    "darkmode",
    "filextensions",
    "classicmenu",
    "endtask",
    "mpo",
    "taskbarleft",
    "stickykeys",
    "numlockstartup",
    "snapflyout",
    "detailedbsod",
    "verboselogon",
  ];

  checkboxItems.forEach((id) => {
    const checkbox = document.getElementById(id);
    if (checkbox) {
      checkbox.addEventListener("change", () => {
        checkbox.checked
          ? scripts[id]?.forEach((script) => addScript(id, script))
          : removeScripts(id);
      });
    }
  });

  const radios = document.querySelectorAll('input[type="radio"]');
  radios.forEach((radio) => {
    radio.addEventListener("change", () => {
      if (radio.checked) {
        const groupName = radio.name;

        document
          .querySelectorAll(`input[type="radio"][name="${groupName}"]`)
          .forEach((otherRadio) => {
            if (otherRadio !== radio) removeScripts(otherRadio.id);
          });
      }
    });
  });
});

// Uncheck all
function uncheckAll() {
  const checkboxes = document.querySelectorAll('input[type="checkbox"]');
  const radios = document.querySelectorAll('input[type="radio"]');
  const indicator = document.querySelectorAll(".indicator");

  window.manualURLs = [];
  document.getElementById("manualList").innerHTML = "";

  checkboxes.forEach((checkbox) => {
    if (checkbox.checked) {
      checkbox.checked = false;
      checkbox.dispatchEvent(new Event("change"));
    }
  });

  radios.forEach((radio) => {
    if (radio.checked) {
      radio.checked = false;
      radio.dispatchEvent(new Event("change"));
    }
  });

  indicator.forEach((indicator) => {
    indicator.textContent = "Off";
  });
}

document.getElementById("uncheckAll").addEventListener("click", uncheckAll);

// Presets
const presets = {
  basic: [
    "cleanmgr",
    "cleantemp",
    "sfc",
    "consumerfeatures",
    "recall",
    "debloatedge",
    "taskbarwidgets",
    "diagaccess",
    "aigenerationaccess",
    "updatepause",
    "activityfeed",
    "wtelemetry",
    "wupdate",
    "wsearchtelemetry",
    "appexperience",
    "targetads",
    "privacyconsent",
    "nvidiatelemetry",
    "ultimateperformance",
    "manualservices",
    "mousedelay",
    "endtask",
  ],
  strict: [
    "cleanmgr",
    "cleantemp",
    "sfc",
    "thirdparty",
    "consumerfeatures",
    "recall",
    "msstoreupdates",
    "debloatedge",
    "copilot",
    "notepadrewrite",
    "aiappxpackages",
    "hideai",
    "aifiles",
    "taskbarwidgets",
    "accinfoaccess",
    "contactsaccess",
    "callhistoryaccess",
    "messagingaccess",
    "emailaccess",
    "tasksaccess",
    "diagaccess",
    "phoneaccess",
    "trustedaccess",
    "calendaraccess",
    "motionaccess",
    "radioaccess",
    "recordingsaccess",
    "screenshotborderaccess",
    "aigenerationaccess",
    "updatepause",
    "cloudsync",
    "activityfeed",
    "screenrecording",
    "automap",
    "wtelemetry",
    "wupdate",
    "wsearchtelemetry",
    "officetelemetry",
    "appexperience",
    "wfeedback",
    "handwriting",
    "windowsdrm",
    "cloudbasedspeech",
    "clipboard",
    "targetads",
    "privacyconsent",
    "nvidiatelemetry",
    "powershelltelemetry",
    "ultimateperformance",
    "manualservices",
    "hags",
    "mousedelay",
    "limitdefender",
    "disableprefetch",
    "endtask",
    "filextensions",
  ],
  extreme: [
    "cleanmgr",
    "cleantemp",
    "dism",
    "sfc",
    "resetnetwork",
    "thirdparty",
    "msapps",
    "xbox",
    "consumerfeatures",
    "recall",
    "microsoftstore",
    "msstoreupdates",
    "onedrive",
    "debloatedge",
    "copilot",
    "notepadrewrite",
    "aiappxpackages",
    "hideai",
    "aifiles",
    "taskbarwidgets",
    "locationaccess",
    "accinfoaccess",
    "contactsaccess",
    "callhistoryaccess",
    "messagingaccess",
    "emailaccess",
    "tasksaccess",
    "diagaccess",
    "voiceactivationaccess",
    "phoneaccess",
    "trustedaccess",
    "calendaraccess",
    "motionaccess",
    "radioaccess",
    "recordingsaccess",
    "screenshotborderaccess",
    "aigenerationaccess",
    "updatepause",
    "cloudsync",
    "activityfeed",
    "notificationtray",
    "screenrecording",
    "automap",
    "default0user",
    "wtelemetry",
    "wupdate",
    "wsearchtelemetry",
    "officetelemetry",
    "appexperience",
    "wfeedback",
    "handwriting",
    "windowsdrm",
    "cloudbasedspeech",
    "clipboard",
    "targetads",
    "privacyconsent",
    "adobetelemetry",
    "nvidiatelemetry",
    "vscodetelemetry",
    "mediatelemetry",
    "powershelltelemetry",
    "ccleanertelemetry",
    "googleupdates",
    "adobeupdates",
    "gamebar",
    "ultimateperformance",
    "manualservices",
    "hags",
    "mousedelay",
    "limitdefender",
    "coreisolation",
    "disableprefetch",
    "storagesense",
    "wsearch",
    "endtask",
    "filextensions",
    "stickykeys",
  ],
};

const applyPreset = (ids) => {
  uncheckAll();
  ids.forEach((id) => {
    const checkbox = document.getElementById(id);
    if (checkbox) {
      checkbox.checked = true;
      checkbox.dispatchEvent(new Event("change"));
    }
  });
};

["basic", "strict", "extreme"].forEach((preset) =>
  document
    .getElementById(`${preset}Preset`)
    .addEventListener("click", () => applyPreset(presets[preset])),
);
